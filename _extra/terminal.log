./run-db.sh 
3f802b4b629173310626aed82c0288287d0b1387c22cbcdc61aaa403008ee29f

journal on  main [!?] via go v1.19.2 
$ go version
go version go1.19.2 linux/amd64

journal on  main [!?] via go v1.19.2 
$ docker ps
CONTAINER ID   IMAGE                COMMAND                  CREATED         STATUS         PORTS                                       NAMES
3f802b4b6291   postgres:14-alpine   "docker-entrypoint.s…"   3 minutes ago   Up 3 minutes   0.0.0.0:5432->5432/tcp, :::5432->5432/tcp   youthful_kapitsa

journal on  main [!?] via go v1.19.2 
$ docker exec -it 3f802b4b6291 psql -U postgres
psql (14.5)
Type "help" for help.

postgres=# \d
          List of relations
 Schema |  Name   | Type  |  Owner   
--------+---------+-------+----------
 public | journal | table | postgres
(1 row)

postgres=# \d journal
                         Table "public.journal"
 Column  |            Type             | Collation | Nullable | Default 
---------+-----------------------------+-----------+----------+---------
 time    | timestamp without time zone |           |          | 
 login   | text                        |           |          | 
 content | text                        |           |          | 
Indexes:
    "journal_time" btree ("time")

postgres=#SELET * FROM journal;
ERROR:  syntax error at or near "SELET"
LINE 1: SELET * FROM journal;
        ^
postgres=# ^D\q

journal on  main [!?] via go v1.19.2 took 1m6s 
$ curl -d@_ws/add-1.json http://localhost:8080/new
404 page not found

journal on  main [!?] via go v1.19.2 
$ curl -d@_ws/add-1.json http://localhost:8080/api/journal
{"error":null,"time":"2022-10-26T10:26:00.372107944+03:00"}

journal on  main [!?] via go v1.19.2 
$ docker exec -it 3f802b4b6291 psql -U postgres           
psql (14.5)
Type "help" for help.

postgres=# SELET * FROM journal;
ERROR:  syntax error at or near "SELET"
LINE 1: SELET * FROM journal;
        ^
postgres=# SELECT * FROM journal;
        time         | login |     content     
---------------------+-------+-----------------
 2022-10-26 10:26:00 | Joe   | My first entry!
(1 row)

postgres=# \q

journal on  main [!?] via go v1.19.2 took 18s 
$curl -d@_ws/add-2.json http://localhost:8080/api/journal
{"error":null,"time":"2022-10-26T10:26:32.846858585+03:00"}

journal on  main [!?] via go v1.19.2 
$ docker exec -it 3f802b4b6291 psql -U postgres           
psql (14.5)
Type "help" for help.

postgres=# SELECT * FROM journal;
ERROR:  relation "journal" does not exist
LINE 1: SELECT * FROM journal;
                      ^
postgres=# \d
Did not find any relations.
postgres=# \q

journal on  main [!?] via go v1.19.2 took 13s 
$ which gp
gp: aliased to git push

journal on  main [?] via go v1.19.2 
$ which go
/home/miki/sdk/go/bin/go

journal on  main [?] via go v1.19.2 
$ # export PATH=${HOME}/sdk/go/bin:${PATH}

journal on  main [?] via go v1.19.2 
$ docker exec -it 3f802b4b6291 psql -U postgres
psql (14.5)
Type "help" for help.

postgres=#SELECT * FROM journal;
ERROR:  relation "journal" does not exist
LINE 1: SELECT * FROM journal;
                      ^
postgres=# ^D\q

journal on  main [?] via go v1.19.2 took 9s 
$ docker exec -it 3f802b4b6291 psql -U postgres
psql (14.5)
Type "help" for help.

postgres=# \d
Did not find any relations.
postgres=# \d
          List of relations
 Schema |  Name   | Type  |  Owner   
--------+---------+-------+----------
 public | journal | table | postgres
(1 row)

postgres=# SELECT * FROM journal;
 time | login | content 
------+-------+---------
(0 rows)

journal on  main [!?] via go v1.19.2 took 29s 
❮ curl -d@_ws/add-2.json http://localhost:8080/api/journal
{"error":null,"time":"2022-10-26T10:59:38.019077295+03:00"}

journal on  main [!?] via go v1.19.2 
❮ docker exec -it 3f802b4b6291 psql -U postgres           
psql (14.5)
Type "help" for help.

postgres=#SELECT * FROM journal;
            time            | login |                  content                   
----------------------------+-------+--------------------------------------------
 2022-10-26 10:59:38.019077 | Joe   | My second entry!'); DROP TABLE journal; --
(1 row)

postgres=# SELECT * FROM journal;
postgres=# \q

journal on  main [!?] via go v1.19.2 took 12m33s 
$ curl -d@_ws/add-2.json http://localhost:8080/api/journal
unexpected EOF
{"error":null,"time":"2022-10-26T11:12:16.505033406+03:00"}

journal on  main [!?] via go v1.19.2 
$ git diff

journal on  main [!?] via go v1.19.2 took 9s 
$ git add -u

journal on  main [+?] via go v1.19.2 
$ git commit -m 'sql injection and sizea limit'
[main ca8e757] sql injection and sizea limit
 3 files changed, 9 insertions(+), 9 deletions(-)

journal on  main [?⇡] via go v1.19.2 
$ git push
Enumerating objects: 11, done.
Counting objects: 100% (11/11), done.
Delta compression using up to 12 threads
Compressing objects: 100% (6/6), done.
Writing objects: 100% (6/6), 756 bytes | 756.00 KiB/s, done.
Total 6 (delta 3), reused 0 (delta 0), pack-reused 0remote: Resolving deltas: 100% (3/3), completed with 3 local objects.
To github.com:353solutions/gosec-1022.git
   6e67c9b..ca8e757  main -> main

journal on  main [?] via go v1.19.2 took 2s 
$ curl -d'{}' http://localhost:8080/api/journal
missing login
{"error":null,"time":"2022-10-26T11:36:54.549599958+03:00"}

journal on  main [!?] via go v1.19.2 
$ !do

journal on  main [!?] via go v1.19.2 
$ docker exec -it 3f802b4b6291 psql -U postgres
psql (14.5)
Type "help" for help.

postgres=# select * from journal;
            time            | login |                  content                   
----------------------------+-------+--------------------------------------------
 2022-10-26 10:59:38.019077 | Joe   | My second entry!'); DROP TABLE journal; --
 2022-10-26 11:12:16.505033 |       | 
 2022-10-26 11:36:54.549599 |       | 
(3 rows)

postgres=# \q

journal on  main [!?] via go v1.19.2 took 21m49s 
$ git add -u

journal on  main [+?] via go v1.19.2 
$ git commit -m 'context'[main ec70eb5] context
 3 files changed, 52 insertions(+), 15 deletions(-)

journal on  main [?⇡] via go v1.19.2 
$ git push
Enumerating objects: 9, done.
Counting objects: 100% (9/9), done.
Delta compression using up to 12 threads
Compressing objects: 100% (5/5), done.
Writing objects: 100% (5/5), 1.07 KiB | 1.07 MiB/s, done.
Total 5 (delta 4), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (4/4), completed with 4 local objects.

journal on  main [?] via go v1.19.2 took 2s 
❮ curl -d@_ws/add-3.json http://localhost:8080/api/journal
{"error":null,"time":"2022-10-26T12:01:20.201350101+03:00"}

journal on  main [?] via go v1.19.2 
$ docker ps
CONTAINER ID   IMAGE                COMMAND                  CREATED       STATUS       PORTS                                       NAMES
3f802b4b6291   postgres:14-alpine   "docker-entrypoint.s…"   2 hours ago   Up 2 hours   0.0.0.0:5432->5432/tcp, :::5432->5432/tcp   youthful_kapitsa

journal on  main via go v1.19.2 
$ docker info 3f802b4b6291
"docker info" accepts no arguments.
See 'docker info --help'.

Usage:  docker info [OPTIONS]

Display system-wide information
journal on  main via go v1.19.2 
$ docker inspect 3f802b4b6291
[
    {
        "Id": "3f802b4b629173310626aed82c0288287d0b1387c22cbcdc61aaa403008ee29f",
        "Created": "2022-10-26T07:20:40.09318722Z",
        "Path": "docker-entrypoint.sh",
        "Args": [
            "postgres"
        ],
        "State": {
            "Status": "running",
            "Running": true,
            "Paused": false,
            "Restarting": false,
            "OOMKilled": false,
            "Dead": false,
            "Pid": 393368,
            "ExitCode": 0,
            "Error": "",
            "StartedAt": "2022-10-26T07:20:40.461649564Z",
            "FinishedAt": "0001-01-01T00:00:00Z"
        },
        "Image": "sha256:aac01494762a1319624f6117a3d9d374540ec58095c2c9f84adb92619aec3b6e",
        "ResolvConfPath": "/var/lib/docker/containers/3f802b4b629173310626aed82c0288287d0b1387c22cbcdc61aaa403008ee29f/resolv.conf",
        "HostnamePath": "/var/lib/docker/containers/3f802b4b629173310626aed82c0288287d0b1387c22cbcdc61aaa403008ee29f/hostname",
        "HostsPath": "/var/lib/docker/containers/3f802b4b629173310626aed82c0288287d0b1387c22cbcdc61aaa403008ee29f/hosts",
        "LogPath": "/var/lib/docker/containers/3f802b4b629173310626aed82c0288287d0b1387c22cbcdc61aaa403008ee29f/3f802b4b629173310626aed82c0288287d0b1387c22cbcdc61aaa403008ee29f-json.log",
        "Name": "/youthful_kapitsa",
        "RestartCount": 0,
        "Driver": "overlay2",
        "Platform": "linux",
        "MountLabel": "",
        "ProcessLabel": "",
        "AppArmorProfile": "docker-default",
        "ExecIDs": null,
        "HostConfig": {
            "Binds": null,
            "ContainerIDFile": "",
            "LogConfig": {
                "Type": "json-file",
                "Config": {}
            },
            "NetworkMode": "default",
            "PortBindings": {
                "5432/tcp": [
                    {
                        "HostIp": "",
                        "HostPort": "5432"
                    }
                ]
            },
            "RestartPolicy": {
                "Name": "no",
                "MaximumRetryCount": 0
            },
            "AutoRemove": false,
            "VolumeDriver": "",
            "VolumesFrom": null,
            "CapAdd": null,
            "CapDrop": null,
            "CgroupnsMode": "private",
            "Dns": [],
            "DnsOptions": [],
            "DnsSearch": [],
            "ExtraHosts": null,
            "GroupAdd": null,
            "IpcMode": "private",
            "Cgroup": "",
            "Links": null,
            "OomScoreAdj": 0,
            "PidMode": "",
            "Privileged": false,
            "PublishAllPorts": false,
            "ReadonlyRootfs": false,
            "SecurityOpt": null,
            "UTSMode": "",
            "UsernsMode": "",
            "ShmSize": 67108864,
            "Runtime": "runc",
            "ConsoleSize": [
                0,
                0
            ],
            "Isolation": "",
            "CpuShares": 0,
            "Memory": 0,
            "NanoCpus": 0,
            "CgroupParent": "",
            "BlkioWeight": 0,
            "BlkioWeightDevice": [],
            "BlkioDeviceReadBps": null,
            "BlkioDeviceWriteBps": null,
            "BlkioDeviceReadIOps": null,
            "BlkioDeviceWriteIOps": null,
            "CpuPeriod": 0,
            "CpuQuota": 0,
            "CpuRealtimePeriod": 0,
            "CpuRealtimeRuntime": 0,
            "CpusetCpus": "",
            "CpusetMems": "",
            "Devices": [],
            "DeviceCgroupRules": null,
            "DeviceRequests": null,
            "KernelMemory": 0,
            "KernelMemoryTCP": 0,
            "MemoryReservation": 0,
            "MemorySwap": 0,
            "MemorySwappiness": null,
            "OomKillDisable": null,
            "PidsLimit": null,
            "Ulimits": null,
            "CpuCount": 0,
            "CpuPercent": 0,
            "IOMaximumIOps": 0,
            "IOMaximumBandwidth": 0,
            "MaskedPaths": [
                "/proc/asound",
                "/proc/acpi",
                "/proc/kcore",
                "/proc/keys",
                "/proc/latency_stats",
                "/proc/timer_list",
                "/proc/timer_stats",
                "/proc/sched_debug",
                "/proc/scsi",
                "/sys/firmware"
            ],
            "ReadonlyPaths": [
                "/proc/bus",
                "/proc/fs",
                "/proc/irq",
                "/proc/sys",
                "/proc/sysrq-trigger"
            ]
        },
        "GraphDriver": {
            "Data": {
                "LowerDir": "/var/lib/docker/overlay2/11dfd45656eb53f583b531e1a98a5935bfa2afd59ca79a80aa8e60201b157315-init/diff:/var/lib/docker/overlay2/34ef04c45a1353e750698e96e2ab517c0b20f47f0d01877362ea4f5c0e35641d/diff:/var/lib/docker/overlay2/df5b1fbb15164c991890eb8849c04dcd001168b7845ff61c185da22d6bc10685/diff:/var/lib/docker/overlay2/aff4d8b24c2ed60a8157e91ea094024949fa1ef984279a9e9f99182ab444b23e/diff:/var/lib/docker/overlay2/7d287201f838d479ef85577b6184050d3626cd98687cb222a058c0642406f3d0/diff:/var/lib/docker/overlay2/23c560a744c25cbf2422b234dd0d70066a1f0675f35be498a5b57625fafbf28a/diff:/var/lib/docker/overlay2/1f3a29f30f38af40f2b14850a45525f48367c3950a91fefa06af2bf1b9f976de/diff:/var/lib/docker/overlay2/d322e56b11da0e3cb9ee2756e57e2367160d176e01a02fb9eb2d07a8f3cd51c1/diff:/var/lib/docker/overlay2/b6b246c57a8132a00d91b20f882b209ef4fae8361f5170f80792f39832067d61/diff",
                "MergedDir": "/var/lib/docker/overlay2/11dfd45656eb53f583b531e1a98a5935bfa2afd59ca79a80aa8e60201b157315/merged",
                "UpperDir": "/var/lib/docker/overlay2/11dfd45656eb53f583b531e1a98a5935bfa2afd59ca79a80aa8e60201b157315/diff",
                "WorkDir": "/var/lib/docker/overlay2/11dfd45656eb53f583b531e1a98a5935bfa2afd59ca79a80aa8e60201b157315/work"
            },
            "Name": "overlay2"
        },
        "Mounts": [
            {
                "Type": "volume",
                "Name": "0459d0b7c027089b6ac27f1df4ea8f163bd6a90232cf877a48b3f94c57a4b83e",
                "Source": "/var/lib/docker/volumes/0459d0b7c027089b6ac27f1df4ea8f163bd6a90232cf877a48b3f94c57a4b83e/_data",
                "Destination": "/var/lib/postgresql/data",
                "Driver": "local",
                "Mode": "",
                "RW": true,
                "Propagation": ""
            }
        ],
        "Config": {
            "Hostname": "3f802b4b6291",
            "Domainname": "",
            "User": "",
            "AttachStdin": false,
            "AttachStdout": false,
            "AttachStderr": false,
            "ExposedPorts": {
                "5432/tcp": {}
            },
            "Tty": false,
            "OpenStdin": false,
            "StdinOnce": false,
            "Env": [
                "POSTGRES_PASSWORD=s3cr3t",
                "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
                "LANG=en_US.utf8",
                "PG_MAJOR=14",
                "PG_VERSION=14.5",
                "PG_SHA256=d4f72cb5fb857c9a9f75ec8cf091a1771272802f2178f0b2e65b7b6ff64f4a30",
                "PGDATA=/var/lib/postgresql/data"
            ],
            "Cmd": [
                "postgres"
            ],
            "Image": "postgres:14-alpine",
            "Volumes": {
                "/var/lib/postgresql/data": {}
            },
            "WorkingDir": "",
            "Entrypoint": [
                "docker-entrypoint.sh"
            ],
            "OnBuild": null,
            "Labels": {},
            "StopSignal": "SIGINT"
        },
        "NetworkSettings": {
            "Bridge": "",
            "SandboxID": "acd87c6f9cf3d73bc8e9149d2755a40293123a2d047eb445781cb85dbe461998",
            "HairpinMode": false,
            "LinkLocalIPv6Address": "",
            "LinkLocalIPv6PrefixLen": 0,
            "Ports": {
                "5432/tcp": [
                    {
                        "HostIp": "0.0.0.0",
                        "HostPort": "5432"
                    },
                    {
                        "HostIp": "::",
                        "HostPort": "5432"
                    }
                ]
            },
            "SandboxKey": "/var/run/docker/netns/acd87c6f9cf3",
            "SecondaryIPAddresses": null,
            "SecondaryIPv6Addresses": null,
            "EndpointID": "a6908f31d0f05862d255bc92b2aabdf85a485a4ed9f78220a2725f5c7b17067d",
            "Gateway": "172.17.0.1",
            "GlobalIPv6Address": "",
            "GlobalIPv6PrefixLen": 0,
            "IPAddress": "172.17.0.2",
            "IPPrefixLen": 16,
            "IPv6Gateway": "",
            "MacAddress": "02:42:ac:11:00:02",
            "Networks": {
                "bridge": {
                    "IPAMConfig": null,
                    "Links": null,
                    "Aliases": null,
                    "NetworkID": "6719d599d30f0d90452e879f88849b7af6d58749d6057806f9a9d2e64b5bb4a7",
                    "EndpointID": "a6908f31d0f05862d255bc92b2aabdf85a485a4ed9f78220a2725f5c7b17067d",
                    "Gateway": "172.17.0.1",
                    "IPAddress": "172.17.0.2",
                    "IPPrefixLen": 16,
                    "IPv6Gateway": "",
                    "GlobalIPv6Address": "",
                    "GlobalIPv6PrefixLen": 0,
                    "MacAddress": "02:42:ac:11:00:02",
                    "DriverOpts": null
                }
            }
        }
    }
]
journal on  main [!] via go v1.19.2 
$ docker inspect -f '{{.NetworkSettings.Ports}}' 3f802b4b6291
map[5432/tcp:[{0.0.0.0 5432} {:: 5432}]]

journal on  main [!] via go v1.19.2 
$ docker inspect -f '{{.NetworkSettings.Ports | json}}' 3f802b4b6291
{"5432/tcp":[{"HostIp":"0.0.0.0","HostPort":"5432"},{"HostIp":"::","HostPort":"5432"}]}

journal on  main [!] via go v1.19.2 
$ git commit -m 'template' html/
[main 3304ba2] template
 1 file changed, 2 insertions(+), 1 deletion(-)

journal on  main [✘!?⇡] via go v1.19.2 
$ git push
Enumerating objects: 7, done.
Counting objects: 100% (7/7), done.
Delta compression using up to 12 threads
Compressing objects: 100% (3/3), done.
Writing objects: 100% (4/4), 451 bytes | 451.00 KiB/s, done.
Total 4 (delta 1), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (1/1), completed with 1 local object.
To github.com:353solutions/gosec-1022.git
   c17fbde..3304ba2  main -> main

journal on  main [✘!?] via go v1.19.2 took 2s 
$ git add -u

journal on  main [✘+?] via go v1.19.2 
$ git commit -m 'custom errors'
[main 99b8d60] custom errors
 4 files changed, 497 insertions(+), 36 deletions(-)
 delete mode 100644 _ws/tmpl.go
journal on  main [?⇡] via go v1.19.2 
$ git push
Enumerating objects: 11, done.
Counting objects: 100% (11/11), done.
Delta compression using up to 12 threads
Compressing objects: 100% (6/6), done.
Writing objects: 100% (6/6), 5.09 KiB | 5.09 MiB/s, done.
Total 6 (delta 4), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (4/4), completed with 4 local objects.
To github.com:353solutions/gosec-1022.git
   3304ba2..99b8d60  main -> main

journal on  main [?] via go v1.19.2 took 2s 
$ echo Back 2pm
Back 2pm

journal on  main [!?] via go v1.19.2 
❮ curl -d@_ws/add-3.json http://localhost:8080/api/journal
curl: (7) Failed to connect to localhost port 8080 after 0 ms: Connection refused

journal on  main [!?] via go v1.19.2 
$ curl -u joe:baz00ka -d@_ws/add-3.json http://localhost:8080/api/journal
curl: (7) Failed to connect to localhost port 8080 after 0 ms: Connection refused

journal on  main [!?] via go v1.19.2 
$ curl -d@_ws/add-3.json http://localhost:8080/api/journal               
Warning: Couldn't read data from file "_ws/add-3.json", this makes an empty 
Warning: POST.
bad creds

journal on  main [!?] via go v1.19.2 
$curl -d@_extra/add-3.json http://localhost:8080/api/journal
bad creds

journal on  main [!?] via go v1.19.2 
$ curl -i -d@_extra/add-3.json http://localhost:8080/api/journal
HTTP/1.1 401 Unauthorized
Content-Type: text/plain; charset=utf-8
X-Content-Type-Options: nosniff
Date: Wed, 26 Oct 2022 11:40:31 GMT
Content-Length: 10

bad creds

journal on  main [!?] via go v1.19.2 
$ curl -u joe:baz00ka -i -d@_extra/add-3.json http://localhost:8080/api/journal
HTTP/1.1 400 Bad Request
Content-Type: text/plain; charset=utf-8
X-Content-Type-Options: nosniff
Date: Wed, 26 Oct 2022 11:40:38 GMT
Content-Length: 14

missing login

journal on  main [!?] via go v1.19.2 
❮ curl -u joe:baz00ka -i -d@_extra/add-1.json http://localhost:8080/api/journal
HTTP/1.1 400 Bad Request
Content-Type: text/plain; charset=utf-8
X-Content-Type-Options: nosniff
Date: Wed, 26 Oct 2022 11:41:23 GMT
Content-Length: 14

missing login
journal on  main [!?] via go v1.19.2 
❮ curl -u joe:baz00ka -i -d@_extra/add-1.json http://localhost:8080/api/journal
HTTP/1.1 200 OK
Content-Type: application/json
Date: Wed, 26 Oct 2022 11:41:58 GMT
Content-Length: 60

{"error":null,"time":"2022-10-26T14:41:58.960417156+03:00"}

journal on  main [!?] via go v1.19.2 
$ git add -u

journal on  main [+?] via go v1.19.2 
$ git commit -m 'auth'
[main 7c3c6a1] auth
 2 files changed, 55 insertions(+), 3 deletions(-)

journal on  main [?⇡] via go v1.19.2 
$ git push
Enumerating objects: 9, done.
Counting objects: 100% (9/9), done.
Delta compression using up to 12 threads
Compressing objects: 100% (5/5), done.
Writing objects: 100% (5/5), 1.04 KiB | 1.04 MiB/s, done.
Total 5 (delta 3), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (3/3), completed with 3 local objects.
To github.com:353solutions/gosec-1022.git
   f6031cd..7c3c6a1  main -> main

journal on  main [?] via go v1.19.2 took 2s 
$ curl http://localhost:8080/debug/pprof404 page not found

journal on  main [!?] via go v1.19.2 
$ curl http://localhost:8080/debug/pprof/profile
404 page not found

journal on  main [✘!?] via go v1.19.2 
$ JOURNAL_PROFILE=yes curl http://localhost:8080/debug/pprof/profile
404 page not found

journal on  main [✘!?] via go v1.19.2 
❮ JOURNAL_PROFILE=yes curl http://localhost:8080/debug/pprof/profile

journal on  main [✘!?] via go v1.19.2 
$ curl http://localhost:8080/debug/pprof/profile                    
^C

journal on  main [✘!?] via go v1.19.2 took 11s 
$ openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes -subj /CN=localhost

Generating a RSA private key
.............................................................................................................................................................++++
.................................................................................................++++
writing new private key to 'key.pem'
-----

journal on  main [✘!?] via go v1.19.2 
$ ls *pem
cert.pem  key.pem

journal on  main [✘!?] via go v1.19.2 
$curl http://localhost:8080/health
Client sent an HTTP request to an HTTPS server.

journal on  main [✘!?] via go v1.19.2 
$ curl https://localhost:8080/health
curl: (60) SSL certificate problem: self signed certificate
More details here: https://curl.se/docs/sslcerts.html

curl failed to verify the legitimacy of the server and therefore could not
establish a secure connection to it. To learn more about this situation and
how to fix it, please visit the web page mentioned above.

journal on  main [✘!?] via go v1.19.2 
$ curl --insecure https://localhost:8080/health
404 page not found

journal on  main [✘!?] via go v1.19.2 
$ curl --insecure https://localhost:8080/api/health
OK

journal on  main [✘!?] via go v1.19.2 
$ curl -i --insecure https://localhost:8080/api/health
HTTP/2 200 
content-type: text/plain; charset=utf-8
content-length: 3
date: Wed, 26 Oct 2022 12:26:29 GMT

OK

journal on  main [✘!?] via go v1.19.2 
$ go env | grep PROX
GONOPROXY=""
GOPROXY="https://proxy.golang.org,direct"
journal on  main [✘!?] via go v1.19.2 
$ go env | grep SUM 
GONOSUMDB=""
GOSUMDB="sum.golang.org"

journal on  main [✘!?] via go v1.19.2 
$ git add .

journal on  main [✘+] via go v1.19.2 
$ git commit -m 'logger'
[main 0bb8c68] logger
 6 files changed, 145 insertions(+), 13 deletions(-)
 create mode 100644 _extra/template_example.go
 create mode 100644 cert.pem
 create mode 100644 key.pem
 delete mode 100644 profile.go

journal on  main [⇡] via go v1.19.2 
$ git push
Enumerating objects: 12, done.
Counting objects: 100% (12/12), done.
Delta compression using up to 12 threads
Compressing objects: 100% (8/8), done.
Writing objects: 100% (8/8), 5.42 KiB | 5.42 MiB/s, done.
Total 8 (delta 3), reused 0 (delta 0), pack-reused 0
remote: Resolving deltas: 100% (3/3), completed with 3 local objects.
To github.com:353solutions/gosec-1022.git
   7c3c6a1..0bb8c68  main -> main

journal on  main via go v1.19.2 took 2s 
$ gosec ./...[gosec] 2022/10/26 16:21:43 Including rules: default
[gosec] 2022/10/26 16:21:43 Excluding rules: default
[gosec] 2022/10/26 16:21:43 Import directory: /home/miki/teaching/secure-go/journal/_extra
[gosec] 2022/10/26 16:21:43 Import directory: /home/miki/teaching/secure-go/journal
[gosec] 2022/10/26 16:21:43 Checking package: main
[gosec] 2022/10/26 16:21:43 Checking file: /home/miki/teaching/secure-go/journal/_extra/template_example.go
[gosec] 2022/10/26 16:21:43 Checking package: main
[gosec] 2022/10/26 16:21:43 Checking file: /home/miki/teaching/secure-go/journal/db.go
[gosec] 2022/10/26 16:21:43 Checking file: /home/miki/teaching/secure-go/journal/main.go
Results:


[/home/miki/teaching/secure-go/journal/main.go:153] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    152: 	w.Header().Set("Content-Type", "application/json")
  > 153: 	json.NewEncoder(w).Encode(resp)
    154: }



[/home/miki/teaching/secure-go/journal/main.go:48] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    47: 	}
  > 48: 	lastTemplate.Execute(w, e)
    49: }



[/home/miki/teaching/secure-go/journal/db.go:60] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    59: 	if _, err := conn.Exec(schemaSQL); err != nil {
  > 60: 		conn.Close()
    61: 		return nil, err



[/home/miki/teaching/secure-go/journal/_extra/template_example.go:26] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    25: 	loc := Location{1.2, 3.4}
  > 26: 	tmpl.Execute(os.Stdout, loc)
    27: }



Summary:
  Gosec  : 2.14.0
  Files  : 3
  Lines  : 347
  Nosec  : 0
  Issues : 4

journal on  main [!?] via go v1.19.2 
$ gosec ./...
[gosec] 2022/10/26 16:22:33 Including rules: default
[gosec] 2022/10/26 16:22:33 Excluding rules: default
[gosec] 2022/10/26 16:22:33 Import directory: /home/miki/teaching/secure-go/journal
[gosec] 2022/10/26 16:22:33 Import directory: /home/miki/teaching/secure-go/journal/_extra
[gosec] 2022/10/26 16:22:34 Checking package: main
[gosec] 2022/10/26 16:22:34 Checking file: /home/miki/teaching/secure-go/journal/_extra/template_example.go
[gosec] 2022/10/26 16:22:34 Checking package: main
[gosec] 2022/10/26 16:22:34 Checking file: /home/miki/teaching/secure-go/journal/db.go
[gosec] 2022/10/26 16:22:34 Checking file: /home/miki/teaching/secure-go/journal/main.go
Results:


[/home/miki/teaching/secure-go/journal/main.go:153] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    152: 	w.Header().Set("Content-Type", "application/json")
  > 153: 	json.NewEncoder(w).Encode(resp)
    154: }



[/home/miki/teaching/secure-go/journal/main.go:48] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    47: 	}
  > 48: 	lastTemplate.Execute(w, e)
    49: }



[/home/miki/teaching/secure-go/journal/db.go:60] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    59: 	if _, err := conn.Exec(schemaSQL); err != nil {
  > 60: 		conn.Close()
    61: 		return nil, err



Summary:
  Gosec  : 2.14.0
  Files  : 3
  Lines  : 348
  Nosec  : 1
  Issues : 3

[/home/miki/teaching/secure-go/journal/db.go:60] - G104 (CWE-703): Errors unhandled. (Confidence: HIGH, Severity: LOW)
    59: 	if _, err := conn.Exec(schemaSQL); err != nil {
  > 60: 		conn.Close()
    61: 		return nil, err



Summary:
  Gosec  : 2.14.0
  Files  : 3
  Lines  : 348
  Nosec  : 1
  Issues : 3


journal on  main [!?] via go v1.19.2 
$ govulncheck .
govulncheck is an experimental tool. Share feedback at https://go.dev/s/govulncheck-feedback.

Scanning for dependencies with known vulnerabilities...
No vulnerabilities found.

=== Informational ===

The vulnerabilities below are in packages that you import, but your code
doesn't appear to call any vulnerable functions. You may not need to take any
action. See https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck
for details.

Vulnerability #1: GO-2022-1059
  An attacker may cause a denial of service by crafting an Accept-Language
  header which ParseAcceptLanguage will take significant time to parse.

  Found in: golang.org/x/text/language@v0.3.7
  Fixed in: golang.org/x/text/language@v0.3.8
  More info: https://pkg.go.dev/vuln/GO-2022-1059

journal on  main [!?] via go v1.19.2 
$